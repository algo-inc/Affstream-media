import{createForm as t,isEqual as e,createEventConstructors as s}from"@felte/core";const i=[],r=()=>{};function n(t,e=r){let s;const n=new Set;function a(e){if(a=e,((r=t)!=r?a==a:r!==a||r&&"object"==typeof r||"function"==typeof r)&&(t=e,s)){const e=!i.length;for(const e of n)e[1](),i.push(e,t);if(e){for(let t=0;t<i.length;t+=2)i[t][0](i[t+1]);i.length=0}}var r,a}return{set:a,update:function(e){a(e(t))},subscribe:function(i,o=r){const d=[i,o];return n.add(d),1===n.size&&(s=e(a)||r),i(t),()=>{n.delete(d),s&&0===n.size&&(s(),s=null)}}}}function a(t){return function(){throw new TypeError(`Can't call "${t}" on HTMLFelteFormElement. The element is not ready yet.`)}}const o=["data","errors","touched","warnings","isSubmitting","isDirty","isValid","isValidating","interacted"];class d extends HTMLElement{constructor(){super(...arguments),this._configuration={},this._storeValues={data:void 0,errors:void 0,touched:void 0,warnings:void 0,isSubmitting:!1,isDirty:!1,isValid:void 0,isValidating:!1,interacted:null},this.setData=a("setData"),this.setFields=a("setFields"),this.setInitialValues=a("setInitialValues"),this.addField=a("addField"),this.unsetField=a("unsetField"),this.swapFields=a("swapFields"),this.moveField=a("moveField"),this.resetField=a("resetField"),this.reset=a("reset"),this.submit=a("submit"),this.createSubmitHandler=a("createSubmitHandler"),this.setErrors=a("setErrors"),this.setTouched=a("setTouched"),this.setWarnings=a("setWarnings"),this.setIsSubmitting=a("setIsSubmitting"),this.setIsDirty=a("setIsDirty"),this.setInteracted=a("setInteracted"),this._ready=!1,this.validate=a("validate"),this._formElement=null,this._updateForm=()=>{var t;const e=this.querySelector("form");e&&e!==this._formElement&&(this.dispatchEvent(new Event("felteconnect",{bubbles:!0,composed:!0})),this._formElement=e,null===(t=this._destroy)||void 0===t||t.call(this),this._destroy=void 0,this._createForm())}}set configuration(t){this._configuration=t,this._destroy&&(this._destroy(),this._destroy=void 0,this._ready=!1,this._createForm())}get configuration(){return this._configuration}get data(){return this._storeValues.data}get errors(){return this._storeValues.errors}get touched(){return this._storeValues.touched}get warnings(){return this._storeValues.warnings}get isSubmitting(){return this._storeValues.isSubmitting}get isDirty(){return this._storeValues.isDirty}get isValid(){return this._storeValues.isValid}get isValidating(){return this._storeValues.isValidating}get interacted(){return this._storeValues.interacted}get ready(){return this._ready}_createForm(){var i;const r=this._formElement;if(!r)return;const a=this.configuration;this.elements=r.elements;const{form:d,cleanup:l,...h}=t(a,{storeFactory:n});this.setData=h.setData,this.setFields=h.setFields,this.setErrors=h.setErrors,this.setTouched=h.setTouched,this.setWarnings=h.setWarnings,this.setIsSubmitting=h.setIsSubmitting,this.setIsDirty=h.setIsDirty,this.setInteracted=h.setInteracted,this.setInitialValues=h.setInitialValues,this.validate=h.validate,this.addField=h.addField,this.unsetField=h.unsetField,this.swapFields=h.swapFields,this.moveField=h.moveField,this.resetField=h.resetField,this.reset=h.reset,this.submit=h.handleSubmit,this.createSubmitHandler=h.createSubmitHandler;const u=o.map((t=>h[t].subscribe((s=>{if(e(s,this._storeValues[t]))return;this._storeValues[t]=s;const i=this[`on${r=t,r.charAt(0).toUpperCase()+r.slice(1)}Change`];var r;"function"==typeof i&&i(s),this.dispatchEvent(new Event(`${t.toLowerCase()}change`))})))),{destroy:c}=d(r),{createSubmitEvent:m,createErrorEvent:v,createSuccessEvent:f}=s(),g=t=>{const e=t,s=m();this.dispatchEvent(s),s.defaultPrevented&&e.preventDefault(),e.onSubmit=s.onSubmit,e.onSuccess=s.onSuccess,e.onError=s.onError},b=t=>{const e=f(t.detail);this.dispatchEvent(e)},_=t=>{const e=t,s=v(e.detail);this.dispatchEvent(s),e.errors=s.errors,s.defaultPrevented&&e.preventDefault()};r.addEventListener("feltesubmit",g),r.addEventListener("feltesuccess",b),r.addEventListener("felteerror",_),this._destroy=()=>{c(),l(),r.removeEventListener("feltesubmit",g),r.removeEventListener("feltesuccess",b),r.removeEventListener("felteerror",_),u.forEach((t=>t()))},this._ready=!0,null===(i=this.onFelteReady)||void 0===i||i.call(this),this.dispatchEvent(new Event("felteready",{bubbles:!0,composed:!0}))}connectedCallback(){setTimeout((()=>{this._updateForm(),this._observer=new MutationObserver(this._updateForm),this._observer.observe(this,{childList:!0})}))}disconnectedCallback(){var t,e;null===(t=this._destroy)||void 0===t||t.call(this),null===(e=this._observer)||void 0===e||e.disconnect()}static get observedAttributes(){return["id"]}attributeChangedCallback(t,e,s){if(e!==s&&"id"===t)this.id=s}}export{d as F};
//# sourceMappingURL=FelteForm-c4d97ee6.js.map
